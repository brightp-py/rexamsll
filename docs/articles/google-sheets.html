<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="examling">
<title>Import from Google Sheets • examling</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import from Google Sheets">
<meta property="og:description" content="examling">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">examling</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/installation.html">Installation</a>
    <a class="dropdown-item" href="../articles/google-sheets.html">Import from Google Sheets</a>
    <a class="dropdown-item" href="../articles/spreadsheet-validation.html">Common Import Errors</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/examLing/examling/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Import from Google Sheets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/examLing/examling/blob/HEAD/vignettes/google-sheets.Rmd" class="external-link"><code>vignettes/google-sheets.Rmd</code></a></small>
      <div class="d-none name"><code>google-sheets.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="section2">Generate <code>.Rmd</code> Files from Google Sheets<a class="anchor" aria-label="anchor" href="#section2"></a>
</h2>
<p><code>examling</code> allows you to conveniently write your test
questions in a Google Sheets document and then import them into
<code>.Rmd</code> files for use with the <code>exams</code> package.</p>
<div class="section level3">
<h3 id="section2_1">Build the Sheet<a class="anchor" aria-label="anchor" href="#section2_1"></a>
</h3>
<p>Create a new Google Sheets document, and fill row 1 with the
following headers:</p>
<ul>
<li><code>ID</code></li>
<li><code>Question</code></li>
<li><code>Type</code></li>
<li><code>Image</code></li>
<li>
<code>Ans1</code>, <code>Ans2</code>, <code>Ans3</code>…*</li>
<li><code>Correct</code></li>
<li><code>Category</code></li>
<li><code>SubCat</code></li>
</ul>
<p><img src="img/howto_googlesheets_01.png"></p>
<p>* You may use any number of <code>Ans</code> columns. Simply label
them accordingly.</p>
<p><strong>Before adding any more text</strong>, click the light gray
box in the top right corner to select the entire spreadsheet.</p>
<p><img src="img/howto_googlesheets_00.png"></p>
<p>Then, set the entire Sheet to plain text. To do this, Press the
button that says “123” (to the left of the font-selection box) and
choose “Plain Text”.</p>
<p><img src="img/howto_googlesheets_06.png"></p>
<p>Doing this ensures that any numbers you input will be saved exactly
as you write them.</p>
<p>To add a question, start by putting a unique identifier in the
<code>ID</code> column. If multiple rows have the same identifier, they
will be associated with each other (See <a href="#section3">Design
Dynamic Questions</a>).</p>
<p>Then, write the main body text of the question in the
<code>Question</code> column. <code>examling</code> uses <a href="https://r02pro.github.io/rmd-text-formating.html" class="external-link">R-markdown</a>
to format text, so you can, for example, <strong>bold</strong> text by
typing “**” on each side.</p>
<p><img src="img/howto_googlesheets_02.png"></p>
<p>The <code>Type</code> column dictates what kind of answer is expected
for this question. There are three main choices:</p>
<ol style="list-style-type: decimal">
<li>
<strong>schoice</strong> - There is a single correct answer, and all
other options are wrong.</li>
<li>
<strong>mchoice</strong> - There is any number of correct answers,
and the student is graded on how many of these select without choosing
incorrect answers.</li>
<li>
<strong>string</strong> - There are no provided answers and the
student is instead given an area to input text. The student’s response
must <em>exactly</em> match the correct answer to receive credit.</li>
</ol>
<p>If the <code>Type</code> is <strong>NOT</strong> “string”, provide
all of the answers that the student will need to choose from in the
columns starting with <code>Ans</code>, including both correct and
incorrect options. You <em>do not</em> need to use all <code>Ans</code>
columns.</p>
<p><img src="img/howto_googlesheets_03.png"></p>
<p>The <code>Correct</code> column is used differently depending on the
<code>Type</code>.</p>
<p>For <strong>schoice</strong> questions, the <code>Correct</code>
value should be the <em>index</em> corresponding to the correct answer.
In the example provided, the correct answer is “Giraffe”, which is under
the column <code>Ans3</code>. Therefore, the <code>Correct</code> column
should say “3”.</p>
<p>For <strong>mchoice</strong> questions, the <code>Correct</code>
value should be a comma-separated list of all correct indices. For
example, if the correct answers lie in the columns <code>Ans1</code> and
<code>Ans3</code>, this cell should say “1, 3”.</p>
<p>For <strong>string</strong> questions, the <code>Correct</code> value
should be the exact correct answer. For example, if the question is
“What color is chlorophyll?”, this cell should say “green”.</p>
<p><img src="img/howto_googlesheets_04.png"></p>
<p>The <code>Category</code> and <code>SubCat</code> columns are used
for organization and naming files. Their values should be short,
informative names that will help you keep track of topics. Questions
with the same <code>Category</code> values should appear on the same
tests.</p>
<p><img src="img/howto_googlesheets_05.png"></p>
<p>Now, add another row for every question you want to generate a
<code>.Rmd</code> file for.</p>
<p><img src="img/howto_googlesheets_07.png"></p>
<p>Give your Sheet a title and, optionally, click “View” -&gt; “Freeze”
-&gt; “1 row” to keep the header row visible while scrolling.</p>
<p><img src="img/howto_googlesheets_08.png"></p>
</div>
<div class="section level3">
<h3 id="extra-columns">Extra Columns<a class="anchor" aria-label="anchor" href="#extra-columns"></a>
</h3>
<p>While the <a href="#section2_1">previous section</a> demonstrates
which columns are <em>required</em> to import questions, they are not
the only columns that are allowed.</p>
<p>A few columns can be added that provide additional functionality,
like the “Image” and “NCorrect” columns.</p>
<p>Any extra columns that do <em>not</em> match one of the names below
will be added to the question’s metadata. This makes it easy to record
searchable tags, warnings, or credits.</p>
<p>As of 23 May, 2023, these extra metadata tags appear in the YAML
header for each respective .Rmd file. Later, these will be added to the
<code>exams</code>-specific “Meta-information” footer.</p>
<div class="section level4">
<h4 id="image">Image<a class="anchor" aria-label="anchor" href="#image"></a>
</h4>
<p>To easily add images to your questions using Google Sheets, start by
inserting a column titled “Image”.</p>
<p><img src="img/howto_image_00.png"></p>
<p>Select the cell in that column corresponding to the question you want
to add an image to. Then, in the top menu, select “Insert” &gt; “Image”
&gt; “Insert image in cell”.</p>
<p><img src="img/howto_image_01.png"></p>
<p>Then, either upload or provide the link to the image you want to
attach, as per Google’s instructions. (For this example, I’ll just use a
screenshot of a function I wrote because I’m too lazy to get a good
image of a tree.)</p>
<p>If the image is large, it should have shrunk down to fit the cell.
This does not affect how it will appear in your exams.</p>
<p><img src="img/howto_image_02.png"></p>
<p>Repeat for each image.</p>
<p>Once you’ve done this, you should be all set to import the questions
using <code><a href="../reference/google2rmd.html">google2rmd()</a></code> as normal. The images will be downloaded
and saved in an <code>img</code> folder in the same directory as the
questions and will appear on the correct questions.</p>
<p>(In case you’re curious what the image I attached was, it’s just a
super simple formula for determining whether a number is even or
odd.)</p>
<p><img src="img/iseven.png"></p>
</div>
<div class="section level4">
<h4 id="section2_3_2">NChoices<a class="anchor" aria-label="anchor" href="#section2_3_2"></a>
</h4>
<p>For some <strong>schoice</strong> and <strong>mchoice</strong>
questions, you may have more options to choose from than you would want
to appear on the test. For example, if the question is “Which letter is
a vowel?”, the choices could be any of the 26 letters of the English
alphabet.</p>
<p>In this case, you can add a column titled “NChoices” and use it to
specify how many options should be given on tests. It is guaranteed that
at least one of the options is the correct answer.</p>
<p><img src="img/extra_col_nchoices_00.png"></p>
<p><img src="img/extra_col_nchoices_01.png"></p>
</div>
<div class="section level4">
<h4 id="ncorrect">NCorrect<a class="anchor" aria-label="anchor" href="#ncorrect"></a>
</h4>
<p>In a similar vein to the <a href="#section2_3_2">NChoices</a> column
is the “NCorrect” column, which specifies how many of the options are
correct answers. This column can <em>only</em> be used for
<strong>mchoice</strong> questions.</p>
<p>If the value in this column is greater than the total number of
choices, it is lowered to that number of choices. For example, if you
set NCorrect to 5 for a question with only 4 possible options, the
NCorrect value will be set to 4.</p>
<p>If there is no value provided in this column, the
<strong>mchoice</strong> question will choose a random number between 1
and the total number of options.</p>
<p><img src="img/extra_col_ncorrect_00.png"></p>
<p><img src="img/extra_col_ncorrect_01.png"></p>
</div>
</div>
<div class="section level3">
<h3 id="section3">Design Dynamic Questions<a class="anchor" aria-label="anchor" href="#section3"></a>
</h3>
<p>It can be useful to group multiple versions of the same question into
one .Rmd file. This can be easily done in the spreadsheet by giving
multiple rows the same value in the “ID” column. Here, we create two
questions that are both related to the feather colors of bird
species.</p>
<p><img src="img/howto_dynamic_01.png"></p>
<p>After calling <code>google2rmd</code> on this spreadsheet, we
generate <a href="../Bird1.txt">a single .Rmd file</a> that contains
both of these versions.</p>
<p>When we run, <code>exams2js</code> on this file, it defaults to the
first variation.</p>
<p><img src="img/howto_dynamic_02.png"></p>
<p>If we want to choose which variation we draw from, we need to use the
<code>R/exams</code> function <code>expar</code>.</p>
<pre><code><span><span class="fu"><a href="../reference/exams2js.html">exams2js</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/exams/man/expar.html" class="external-link">expar</a></span><span class="op">(</span><span class="st">"Bird1.Rmd"</span>, qvariation <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p><img src="img/howto_dynamic_03.png"></p>
<p>However, a lot of information in the spreadsheet is redundant. The
“Type”, “Category”, and “Subcat” columns, as well as all three “Ans#”
columns, are the same between the two variations.</p>
<p><code>examling</code> will copy any data it needs from earlier
variations of the questions automatically, so we can safely omit the
repeated data from the second variation of the question.</p>
<p><img src="img/howto_dynamic_04.png"></p>
</div>
<div class="section level3">
<h3 id="import-into-r">Import into R<a class="anchor" aria-label="anchor" href="#import-into-r"></a>
</h3>
<p>Start by loading in the <code>examling</code> package.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://examling.examLing.org" class="external-link">examling</a></span><span class="op">)</span></span></code></pre>
<p>Use <code>setwd</code> to place your <a href="https://support.posit.co/hc/en-us/articles/200711843-Working-Directories-and-Workspaces-in-the-RStudio-IDE" class="external-link">working
directory</a> where you want the folder of .Rmd files to be saved.</p>
<p>Then navigate back to the spreadsheet containing your questions and
copy the <em>entire</em> URL (“<a href="https://docs.google.com/spreadsheets/d/" class="external-link uri">https://docs.google.com/spreadsheets/d/</a>…”).</p>
<p>Paste the URL into the first argument <code>url</code> of the
examling function <code>google2rmd</code>. Set the second argument
<code>output_dir</code> to the folder you want to store the resulting
.Rmd files in.</p>
<pre><code><span><span class="fu"><a href="../reference/google2rmd.html">google2rmd</a></span><span class="op">(</span></span>
<span>   <span class="st">"&lt;URL&gt;"</span>,</span>
<span>   <span class="st">"Example"</span></span>
<span><span class="op">)</span></span></code></pre>
<p>If you are loading questions from a sheet of the spreadsheet
<em>other than the first</em>, you’ll need to specify the index or name
of that sheet in <code>google2rmd</code>. For example, if you’re on
“Sheet2”, include <code>sheet = 2</code> or
<code>sheet = "Sheet2"</code>.</p>
<p><img src="img/howto_import_r_00.png"></p>
<pre><code><span><span class="fu"><a href="../reference/google2rmd.html">google2rmd</a></span><span class="op">(</span></span>
<span>   <span class="st">"&lt;URL&gt;"</span>,</span>
<span>   <span class="st">"Example"</span>,</span>
<span>   sheet <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre>
<p>NOTE: The index depends on the <em>order</em> of the sheets, not
their names. In the following screenshot, “Sheet3” has been placed
before “Sheet2”. Here, “Sheet3” would have index <code>2</code>, and
“Sheet2” would have index <code>3</code>.</p>
<p><img src="img/howto_import_r_01.png"></p>
<p>Once you run the function, you should be asked to grant access to
your Google account. You should select “Send me to the browser for a new
auth process.” in the R terminal. Even if “pre-authorized accounts” are
available, they aren’t very reliable, so stick to logging in each time
you start a fresh R session.</p>
<p>When sent to the browser, select the account that your spreadsheet is
stored under and sign in. You should be presented with the following
screen.</p>
<p><img src="img/howto_import_r_02.png"></p>
<p>Check the box labeled “See, edit, create, and delete all of your
Google Drive files.” and press the “Continue” button.</p>
<p>And the process is done! Assuming there are no issues with your
spreadsheet, R will load the proper Google Sheets document and save all
of the .Rmd files under the correct folder. <code>examling</code> also
creates a log file that details the import process, which can be found
in the <code>logs/log</code> folder with the name
<code>{DATE}_{TIME}.log</code>.</p>
<p>If there <em>is</em> an error, you’ll also see a file called
<code>{DATE}_{TIME}.msg</code> in this folder.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Brighton Pauli.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
