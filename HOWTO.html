<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>1 Install • rexamsll</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="1 Install"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">rexamsll</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/google-sheets.html">google-sheets</a>
    <a class="dropdown-item" href="articles/installation.html">installation</a>
    <a class="dropdown-item" href="articles/spreadsheet-validation.html">spreadsheet-validation</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/examLing/rexamsll/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>1 Install</h1>
      <small class="dont-index">Source: <a href="https://github.com/examLing/rexamsll/blob/HEAD/HOWTO.md" class="external-link"><code>HOWTO.md</code></a></small>
    </div>


<p>This document should be integrated into <code>pkgdown</code> once it is available.</p>
<div id="id_1-install" class="section level1">

<p>While <code>rexamsll</code> is in development, the most recently pushed version can be installed through GitHub using the devtools library.</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span></code></pre>
<p>In order to gain access to this package’s source code, you’ll need a GitHub account and permission from a project administrator to access the repository. If haven’t worked with git before, check out <a href="https://docs.github.com/en/get-started/getting-started-with-git" class="external-link uri">https://docs.github.com/en/get-started/getting-started-with-git</a>.</p>
<p>Once you have a git account, you need to create an authentication token so R can access your repositories. This just means signing in once to get a special password from GitHub that R can use from then on.</p>
<p>To start, input your GitHub username and the email associated with your account in their respective strings below, and run the code cell.</p>
<pre><code><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_git_config.html" class="external-link">use_git_config</a></span><span class="op">(</span>user.name <span class="op">=</span> <span class="st">"&lt;USERNAME&gt;"</span>,</span>
<span>                        user.email <span class="op">=</span> <span class="st">"&lt;YOUR&gt;@&lt;EMAIL&gt;.com"</span><span class="op">)</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/github-token.html" class="external-link">create_github_token</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>This should open your browser and ask you to sign into GitHub before bringing you to a page titled “New personal access token”.</p>
<p>Start by providing a reason for this token’s creation in the “Note” section. You can also change the expiration date on the token, though the default value of 30 days works perfectly well.</p>
<p><img src="img/howto_install_00.png"></p>
<p>You should not need to change any of the selections in the “Select scopes” section. The “repo” section that is enabled by default should be all that you need to give R access to.</p>
<p><img src="img/howto_install_01.png"></p>
<p>Now, click the green “Create Token” at the bottom of the page. You should be presented with a page that looks like the following, with some code that starts with <code>ghp_</code>. (Note that the code has been censored in this example image.)</p>
<p><img src="img/howto_install_02.png"></p>
<p>Copy this code and, optionally, save it somewhere secure to use later. Paste it over the text that says <code>&lt;AUTH CODE HERE&gt;</code> in the chunk below. Be sure to delete the <code>&lt;</code> and <code>&gt;</code>; only your authentication code should be within the quotes. Then run the code chunk to install rexamsll.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"examLing/rexamsll"</span>, ref <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>               auth_token <span class="op">=</span> <span class="st">"&lt;AUTH CODE HERE&gt;"</span><span class="op">)</span></span></code></pre>
<p>To check that rexamsll was installed properly, run the following code chunk and make sure there are no errors.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rexamsll.examLing.org" class="external-link">rexamsll</a></span><span class="op">)</span></span></code></pre>
</div>
<div class="section level1">
<h1 id="id_2-generate-rmd-files-from-google-sheets">2 Generate <code>.Rmd</code> Files from Google Sheets<a class="anchor" aria-label="anchor" href="#id_2-generate-rmd-files-from-google-sheets"></a></h1>
<p><code>rexamsll</code> allows you to conveniently write your test questions in a Google Sheets document and then import them into <code>.Rmd</code> files for use with the <code>exams</code> package.</p>
<div class="section level2">
<h2 id="id_21-build-the-sheet">2.1 Build the Sheet<a class="anchor" aria-label="anchor" href="#id_21-build-the-sheet"></a></h2>
<p>Create a new Google Sheets document, and fill row 1 with the following headers:</p>
<ul><li><code>ID</code></li>
<li><code>Question</code></li>
<li><code>Type</code></li>
<li><code>Image</code></li>
<li>
<code>Ans1</code>, <code>Ans2</code>, <code>Ans3</code>…*</li>
<li><code>Correct</code></li>
<li><code>Category</code></li>
<li><code>SubCat</code></li>
</ul><p><img src="img/howto_googlesheets_01.png"></p>
<p>* You may use any number of <code>Ans</code> columns. Simply label them accordingly.</p>
<p><strong>Before adding any more text</strong>, click the light gray box in the top right corner to select the entire spreadsheet.</p>
<p><img src="img/howto_googlesheets_00.png"></p>
<p>Then, set the entire Sheet to plain text. To do this, Press the button that says “123” (to the left of the font-selection box) and choose “Plain Text”.</p>
<p><img src="img/howto_googlesheets_06.png"></p>
<p>Doing this ensures that any numbers you input will be saved exactly as you write them.</p>
<p>To add a question, start by putting a unique identifier in the <code>ID</code> column. If multiple rows have the same identifier, they will be associated with each other (See <a href="#section3">Design Dynamic Questions</a>).</p>
<p>Then, write the main body text of the question in the <code>Question</code> column. <code>rexamsll</code> uses <a href="https://r02pro.github.io/rmd-text-formating.html" class="external-link">R-markdown</a> to format text, so you can, for example, <strong>bold</strong> text by typing “**” on each side.</p>
<p><img src="img/howto_googlesheets_02.png"></p>
<p>The <code>Type</code> column dictates what kind of answer is expected for this question. There are three main choices:</p>
<ol style="list-style-type: decimal"><li>
<strong>schoice</strong> - There is a single correct answer, and all other options are wrong.</li>
<li>
<strong>mchoice</strong> - There is any number of correct answers, and the student is graded on how many of these select without choosing incorrect answers.</li>
<li>
<strong>string</strong> - There are no provided answers and the student is instead given an area to input text. The student’s response must <em>exactly</em> match the correct answer to receive credit.</li>
</ol><p>If the <code>Type</code> is <strong>NOT</strong> “string”, provide all of the answers that the student will need to choose from in the columns starting with <code>Ans</code>, including both correct and incorrect options. You <em>do not</em> need to use all <code>Ans</code> columns.</p>
<p><img src="img/howto_googlesheets_03.png"></p>
<p>The <code>Correct</code> column is used differently depending on the <code>Type</code>.</p>
<p>For <strong>schoice</strong> questions, the <code>Correct</code> value should be the <em>index</em> corresponding to the correct answer. In the example provided, the correct answer is “Giraffe”, which is under the column <code>Ans3</code>. Therefore, the <code>Correct</code> column should say “3”.</p>
<p>For <strong>mchoice</strong> questions, the <code>Correct</code> value should be a comma-separated list of all correct indices. For example, if the correct answers lie in the columns <code>Ans1</code> and <code>Ans3</code>, this cell should say “1, 3”.</p>
<p>For <strong>string</strong> questions, the <code>Correct</code> value should be the exact correct answer. For example, if the question is “What color is chlorophyll?”, this cell should say “green”.</p>
<p><img src="img/howto_googlesheets_04.png"></p>
<p>The <code>Category</code> and <code>SubCat</code> columns are used for organization and naming files. Their values should be short, informative names that will help you keep track of topics. Questions with the same <code>Category</code> values should appear on the same tests.</p>
<p><img src="img/howto_googlesheets_05.png"></p>
<p>Now, add another row for every question you want to generate a <code>.Rmd</code> file for.</p>
<p><img src="img/howto_googlesheets_07.png"></p>
<p>Give your Sheet a title and, optionally, click “View” -&gt; “Freeze” -&gt; “1 row” to keep the header row visible while scrolling.</p>
<p><img src="img/howto_googlesheets_08.png"></p>
</div>
<div class="section level2">
<h2 id="id_22-import-into-r">2.2 Import into R<a class="anchor" aria-label="anchor" href="#id_22-import-into-r"></a></h2>
<p>Start by loading in the <code>rexamsll</code> package.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rexamsll.examLing.org" class="external-link">rexamsll</a></span><span class="op">)</span></span></code></pre>
<p>Use <code>setwd</code> to place your <a href="https://support.posit.co/hc/en-us/articles/200711843-Working-Directories-and-Workspaces-in-the-RStudio-IDE" class="external-link">working directory</a> where you want the folder of .Rmd files to be saved.</p>
<p>Then navigate back to the spreadsheet containing your questions and copy the <em>entire</em> URL (“<a href="https://docs.google.com/spreadsheets/d/" class="external-link uri">https://docs.google.com/spreadsheets/d/</a>…”).</p>
<p>Paste the URL into the first argument <code>url</code> of the rexamsll function <code>google2rmd</code>. Set the second argument <code>output_dir</code> to the folder you want to store the resulting .Rmd files in.</p>
<pre><code><span><span class="fu"><a href="reference/google2rmd.html">google2rmd</a></span><span class="op">(</span></span>
<span>   <span class="st">"&lt;URL&gt;"</span>,</span>
<span>   <span class="st">"Example"</span></span>
<span><span class="op">)</span></span></code></pre>
<p>If you are loading questions from a sheet of the spreadsheet <em>other than the first</em>, you’ll need to specify the index of that sheet in <code>google2rmd</code>. For example, if you’re on “Sheet2”, include <code>sheet = 2</code>.</p>
<p><img src="img/howto_import_r_00.png"></p>
<pre><code><span><span class="fu"><a href="reference/google2rmd.html">google2rmd</a></span><span class="op">(</span></span>
<span>   <span class="st">"&lt;URL&gt;"</span>,</span>
<span>   <span class="st">"Example"</span>,</span>
<span>   sheet <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre>
<p>NOTE: This index depends on the <em>order</em> of the sheets, not their names. In the following screenshot, “Sheet3” has been placed before “Sheet2”. Here, “Sheet3” would have index <code>2</code>, and “Sheet2” would have index <code>3</code>.</p>
<p><img src="img/howto_import_r_01.png"></p>
<p>Once you run the function, you should be asked to grant access to your Google account. You should select “Send me to the browser for a new auth process.” in the R terminal. Even if “pre-authorized accounts” are available, they aren’t very reliable, so stick to logging in each time you start a fresh R session.</p>
<p>When sent to the browser, select the account that your spreadsheet is stored under and sign in. You should be presented with the following screen.</p>
<p><img src="img/howto_import_r_02.png"></p>
<p>Check the box labeled “See, edit, create, and delete all of your Google Drive files.” and press the “Continue” button.</p>
<p>And the process is done! Assuming there are no issues with your spreadsheet, R will load the proper Google Sheets document and save all of the .Rmd files under the correct folder. <code>rexamsll</code> also creates a log file that details the import process, which can be found in the <code>logs/log</code> folder with the name <code>{DATE}_{TIME}.log</code>.</p>
<p>If there <em>is</em> an error, you’ll also see a file called <code>{DATE}_{TIME}.msg</code> in this folder.</p>
</div>
<div class="section level2">
<h2 id="id_23-extra-columns">2.3 Extra Columns<a class="anchor" aria-label="anchor" href="#id_23-extra-columns"></a></h2>
<p>While <a href="#section2_1">Section 2.1</a> demonstrates which columns are <em>required</em> to import questions, they are not the only columns that are <em>allowed</em>.</p>
<p>A few columns can be added that provide additional functionality, like the “Image” and “NCorrect” columns.</p>
<p>Any extra columns that do <em>not</em> match one of the names below will be added to the question’s metadata. This makes it easy to record searchable tags, warnings, or credits.</p>
<p>As of 23 May, 2023, these extra metadata tags appear in the YAML header for each respective .Rmd file. Later, these will be added to the <code>exams</code>-specific “Meta-information” footer.</p>
<div class="section level3">
<h3 id="image">Image<a class="anchor" aria-label="anchor" href="#image"></a></h3>
<p>The “Image” column deserves its own section. See <a href="#section2_4">Adding Images</a>.</p>
</div>
<div class="section level3">
<h3 id="nchoices">NChoices<a class="anchor" aria-label="anchor" href="#nchoices"></a></h3>
<p>For some <strong>schoice</strong> and <strong>mchoice</strong> questions, you may have more options to choose from than you would want to appear on the test. For example, if the question is “Which letter is a vowel?”, the choices could be any of the 26 letters of the English alphabet.</p>
<p>In this case, you can add a column titled “NChoices” and use it to specify how many options should be given on tests. It is guaranteed that at least one of the options is the correct answer.</p>
<p><img src="img/extra_col_nchoices_00.png"></p>
<p><img src="img/extra_col_nchoices_01.png"></p>
</div>
<div class="section level3">
<h3 id="ncorrect">NCorrect<a class="anchor" aria-label="anchor" href="#ncorrect"></a></h3>
<p>In a similar vein to the <a href="#section2_3_2">NChoices</a> column is the “NCorrect” column, which specifies how many of the options are correct answers. This column can <em>only</em> be used for <strong>mchoice</strong> questions.</p>
<p>If the value in this column is greater than the total number of choices, it is lowered to that number of choices. For example, if you set NCorrect to 5 for a question with only 4 possible options, the NCorrect value will be set to 4.</p>
<p>If there is no value provided in this column, the <strong>mchoice</strong> question will choose a random number between 1 and the total number of options.</p>
<p><img src="img/extra_col_ncorrect_00.png"></p>
<p><img src="img/extra_col_ncorrect_01.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="id_24-add-images">2.4 Add Images<a class="anchor" aria-label="anchor" href="#id_24-add-images"></a></h2>
<p>To easily add images to your questions using Google Sheets, start by inserting a column titled “Image”.</p>
<p><img src="img/howto_image_00.png"></p>
<p>Select the cell in that column corresponding to the question you want to add an image to. Then, in the top menu, select “Insert” &gt; “Image” &gt; “Insert image in cell”.</p>
<p><img src="img/howto_image_01.png"></p>
<p>Then, either upload or provide the link to the image you want to attach, as per Google’s instructions. (For this example, I’ll just use a screenshot of a function I wrote because I’m too lazy to get a good image of a tree.)</p>
<p>If the image is large, it should have shrunk down to fit the cell. This does not affect how it will appear in your exams.</p>
<p><img src="img/howto_image_02.png"></p>
<p>Repeat for each image.</p>
<p><strong>THIS NEXT PART IS IMPORTANT.</strong></p>
<p>There is no way for R to know which cells do or do not contain images. Using “Insert image in cell” is only for your viewing convenience. Behind the scenes, the cell still appears to be empty!</p>
<p>In order to communicate to <code>rexamsll</code> which questions have the attached images, you need to type “0” in the “Image” column for every question that does <em>not</em> have an image.</p>
<p><img src="img/howto_image_03.png"></p>
<p>Once you’ve done this, you should be all set to import the questions using <code><a href="reference/google2rmd.html">google2rmd()</a></code> as normal. The images will be downloaded and saved in an <code>img</code> folder in the same directory as the questions, and, as long as you properly added “0”s, they will appear on the correct questions.</p>
<p>(In case you’re curious what the image I attached was, it’s just a super simple formula for determining whether a number is even or odd.)</p>
<p><img src="img/iseven.png"></p>
</div>
</div>
<div class="section level1">
<h1 id="id_3-design-dynamic-questions">3 Design Dynamic Questions<a class="anchor" aria-label="anchor" href="#id_3-design-dynamic-questions"></a></h1>
<p>Todo</p>
</div>
<div class="section level1">
<h1 id="a1-spreadsheet-validation">A1 Spreadsheet Validation<a class="anchor" aria-label="anchor" href="#a1-spreadsheet-validation"></a></h1>
<p>When importing questions from a spreadsheet, like one created in Google Sheets or Excel, <code>rexamsll</code> goes through a list of checks to validate the sheet. If any check fails, your function will throw an error.</p>
<div class="section level2">
<h2 id="dataframe-has-no-values">“Dataframe has no values.”<a class="anchor" aria-label="anchor" href="#dataframe-has-no-values"></a></h2>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> rexamsll<span class="sc">:::</span><span class="fu">validate_df</span>(df) <span class="sc">:</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  Dataframe has no values. Did you select the wrong sheet?</span></code></pre></div>
<p>This error occurs when you try to import data from a spreadsheet that with only a header. Double check that you pasted the correct url and that you selected the proper sheet index.</p>
<p>Also, it’s good to note that images don’t count as cell values.</p>
</div>
<div class="section level2">
<h2 id="error-in-if-nrowdf--0">“Error in if (nrow(df) == 0)…”<a class="anchor" aria-label="anchor" href="#error-in-if-nrowdf--0"></a></h2>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="cf">if</span> (<span class="fu">nrow</span>(df) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">"Dataframe has no values. Did you select the wrong sheet?"</span>) <span class="sc">:</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  argument is of length zero</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>In addition<span class="sc">:</span> Warning message<span class="sc">:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>No data found on worksheet.</span></code></pre></div>
<p>This error occurs when you try to import data from a spreadsheet with <em>no</em> values (not even a header). Since there is no data in the sheet, R fails to load it at all.</p>
<p>Double check that you’re importing from the correct URL and sheet.</p>
</div>
<div class="section level2">
<h2 id="missing-columns-">“Missing columns: …”<a class="anchor" aria-label="anchor" href="#missing-columns-"></a></h2>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> rexamsll<span class="sc">:::</span><span class="fu">validate_df</span>(df) <span class="sc">:</span> Missing columns<span class="sc">:</span> type</span></code></pre></div>
<p><img src="img/app_missing_col_00.png"></p>
<p>Your header is missing at least one of the required columns:</p>
<ul><li>Question</li>
<li>Type</li>
<li>Correct</li>
<li>Category</li>
<li>Subcat</li>
</ul><p>Add the listed headers to the first row of your sheet, and check <a href="#section2_1">Build the Sheet</a> to learn how to use each of these columns.</p>
<p>Side note: Interestingly, these headers don’t need to be on the first row; they just need to be the first <em>non-empty</em> row of the sheet. You can have as many <em>empty</em> rows above them as you’d like.</p>
</div>
<div class="section level2">
<h2 id="no-answer-columns-found">“No answer columns found”<a class="anchor" aria-label="anchor" href="#no-answer-columns-found"></a></h2>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> rexamsll<span class="sc">:::</span><span class="fu">validate_df</span>(df) <span class="sc">:</span> No answer columns found</span></code></pre></div>
<p><img src="img/app_no_ans_col_found_00.png"></p>
<p><code>rexamsll</code> requires at least ONE column of the format “Ans#” in the sheet, or it will throw this error.</p>
<p>At the moment, <code>rexamsll</code> throws this error even if all questions are of the <strong>string</strong> type, meaning the columns are empty. In this case, just add a single “Ans1” column and leave it blank.</p>
</div>
<div class="section level2">
<h2 id="no-values-in-answer-columns">“No values in answer columns.”<a class="anchor" aria-label="anchor" href="#no-values-in-answer-columns"></a></h2>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">which</span>(na_rows <span class="sc">&amp;</span> <span class="sc">!</span>sr_rows) <span class="sc">%&gt;%</span> <span class="fu">paste0</span>(<span class="at">collapse =</span> <span class="st">", "</span>) <span class="sc">%&gt;%</span> <span class="fu">sprintf</span>(msg,  <span class="sc">:</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  Row <span class="dv">1</span> has no values <span class="cf">in</span> answer columns.</span></code></pre></div>
<p><img src="img/app_no_ans_vals_00.png"></p>
<p>This error is thrown when a <strong>schoice</strong> or <strong>mchoice</strong> question has no answers to choose from. To fix this, <em>either</em>:</p>
<ol style="list-style-type: decimal"><li>Add answers to this row.</li>
<li>Set the “Type” to <strong>string</strong>.</li>
</ol></div>
</div>


  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brighton Pauli.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

